<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="main.css">

</head>

<body class="">

    <div class="container">
        <div class="keyboard_wrapp">
            <div class="keyboard_lights"></div>
            <div class="keyboard_keys">
                <div class="row">
                    <div class="keys"></div>
                    <div class="keys">ㄅ</div>
                    <div class="keys">ㄉ</div>
                    <div class="keys" style="font-size: 80px; padding-top: 40px;">ˇ</div>
                    <div class="keys" style="font-size: 80px; padding-top: 40px;">ˋ</div>
                    <div class="keys">ㄓ</div>
                    <div class="keys" style="font-size: 80px; padding-top: 40px;">ˊ</div>
                    <div class="keys" style="font-size: 80px; padding-top: 40px;">˙</div>
                    <div class="keys">ㄚ</div>
                    <div class="keys">ㄞ</div>
                    <div class="keys">ㄢ</div>
                    <div class="keys">ㄦ</div>
                    <div class="keys"></div>
                    <div class="keys backspace_key">刪除<br>&nbsp&nbsp←</div>
                </div>
                <div class="row">
                    <div class="keys tab_key"></div>
                    <div class="keys">ㄆ</div>
                    <div class="keys">ㄊ</div>
                    <div class="keys">ㄍ</div>
                    <div class="keys">ㄐ</div>
                    <div class="keys">ㄔ</div>
                    <div class="keys">ㄗ</div>
                    <div class="keys">ㄧ</div>
                    <div class="keys">ㄛ</div>
                    <div class="keys">ㄟ</div>
                    <div class="keys">ㄣ</div>
                    <div class="keys"></div>
                    <div class="keys"></div>
                    <div class="keys slash_key"></div>
                </div>
                <div class="row">
                    <div class="keys caps_lock_key"></div>
                    <div class="keys">ㄇ</div>
                    <div class="keys">ㄋ</div>
                    <div class="keys">ㄎ</div>
                    <div class="keys">ㄑ</div>
                    <div class="keys">ㄕ</div>
                    <div class="keys">ㄘ</div>
                    <div class="keys">ㄨ</div>
                    <div class="keys">ㄜ</div>
                    <div class="keys">ㄠ</div>
                    <div class="keys">ㄤ</div>
                    <div class="keys"></div>
                    <div class="keys enter_key">確定</div>
                </div>
                <div class="row">
                    <div class="keys shift_key shift_left"></div>
                    <div class="keys">ㄈ</div>
                    <div class="keys">ㄌ</div>
                    <div class="keys">ㄏ</div>
                    <div class="keys">ㄒ</div>
                    <div class="keys">ㄖ</div>
                    <div class="keys">ㄙ</div>
                    <div class="keys">ㄩ</div>
                    <div class="keys">ㄝ</div>
                    <div class="keys">ㄡ</div>
                    <div class="keys">ㄥ</div>
                    <div class="keys"></div>
                    <div class="keys shift_key shift_right"></div>
                </div>
                <div class="row">
                    <div class="keys ctrl_key ctrl_left"></div>
                    <div class="keys win_key"></div>
                    <div class="keys alt_key alt_left"></div>
                    <div class="keys space_key">一聲</div>
                    <div class="keys alt_key alt_right"></div>
                    <div class="keys"></div>
                    <div class="keys ctrl_key ctrl_right"></div>
                </div>
            </div>
        </div>

        <table >
            <tr>
                <td >杯</td>
                <td >◠<br>◡</td>
                <td >子</td>
                <td >◠<br>◡</td>
                <td style="padding-left: 50px;">
                    <img width="100%" src="coffee-cup2.png" alt="">
                    <br>
                    <button style="margin-left: 30px; margin-top: -40px;" class="btn " id="speak">播放提示</button>
                </td>
            </tr>

        </table>




        <div class="textContainer text">
        </div>


    </div>

    <script>
        let allKey = document.querySelectorAll(".keys");
        let textContainer = document.querySelector(".textContainer");
        let deleteKey = document.querySelector(".backspace_key");
        let row1 = ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'];
        let row1_c = row1.map(function (x) {
            return x.toUpperCase();
        });
        let row2 = ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', ';'];
        let row2_c = row2.map(function (x) {
            return x.toUpperCase();
        });
        let row3 = ['z', 'x', 'c', 'v', 'b', 'n', 'm', ',', '.', '/'];
        let row3_c = row3.map(function (x) {
            return x.toUpperCase();
        });

        function del_txt() {
            let textContainerContent = textContainer.innerText;
            if (textContainerContent.length == 0) {
                return;
            }
            console.log(textContainerContent);
            let newContent = textContainerContent.slice(0, textContainerContent.length - 1);
            textContainer.innerText = newContent;
        }

        deleteKey.addEventListener("click", function () {
            del_txt();
        })

        for (let key of allKey) {
            key.addEventListener("click", function () {
                if (key.classList.contains("backspace_key") || key.classList.contains("enter_key")) {
                    return;
                }
                textContainer.innerText += key.innerText;
            })
        }

        for (let i = 0; i < 10; i++) {
            if (i == 0) {
                allKey[10].setAttribute('keyname', 0);
                allKey[11].setAttribute('keyname', '-');
                allKey[13].setAttribute('keyname', 'Backspace');
                allKey[40].setAttribute('keyname', 'Enter');
                allKey[57].setAttribute('keyname', ' ');
            }
            else {
                allKey[i].setAttribute('keyname', i);
            }
        }

        for (let i = 15; i < 25; i++) {
            allKey[i].setAttribute('keyname', row1[i - 15]);
            allKey[i].setAttribute('keyname_c', row1_c[i - 15]);
        }

        for (let i = 29; i < 39; i++) {
            allKey[i].setAttribute('keyname', row2[i - 29]);
            allKey[i].setAttribute('keyname_c', row2_c[i - 29]);
        }

        for (let i = 42; i < 52; i++) {
            allKey[i].setAttribute('keyname', row3[i - 42]);
            allKey[i].setAttribute('keyname_c', row3_c[i - 42]);
        }



        window.addEventListener('keydown', function (e) {
            for (let i = 0; i < allKey.length; i++) {
                if (e.key == allKey[i].getAttribute('keyname') || e.key == allKey[i].getAttribute('keyname_c')) {
                    if (i == 13) {
                        del_txt();
                    }
                    allKey[i].classList.add('active')
                }
            }
        })

        window.addEventListener('keyup', function (e) {

            for (let i = 0; i < allKey.length; i++) {
                if (e.key == allKey[i].getAttribute('keyname') || e.key == allKey[i].getAttribute('keyname_c')) {
                    if (i == 13) {
                        del_txt();
                    }
                    else if (i == 40) {

                    }
                    else {
                        textContainer.innerText += allKey[i].innerHTML;
                    }
                    allKey[i].classList.remove('active')
                    allKey[i].classList.add('remove')
                }
            }
        })

        let intervalId;

        document.addEventListener('mousedown', function (e) {
            if (e.button === 0) { // 0 表示左鍵
                for (let i = 0; i < allKey.length; i++) {
                    if (e.target === allKey[i]) {
                        if (i === 13) {
                            intervalId = setInterval(del_txt, 100); // 每 100 毫秒執行一次 del_txt 函數
                        }
                    }
                }
            }
        });

        document.addEventListener('mouseup', function (e) {
            if (e.button === 0) { // 0 表示左鍵
                clearInterval(intervalId); // 停止重複執行 del_txt 函數
            }
        });

    </script>


</body>

</html>